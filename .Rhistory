panel.grid = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
panel.border = element_blank())
#plot.margin = unit(c(1,2,1,2), "cm"))
#p1 = ggplotly(p)
p
source("analysis.R")
world = read.csv('data/worldData.csv')
source("analysis.R")
install.packages("shinythemes")
source("analysis.R")
data_df
japan_2013 %>% group_by(Sex) %>% count(Smoking.status) %>%
ggplot(aes(Sex, n))+
geom_bar(stat = 'identity', aes(fill= Smoking.status),position='dodge')
per_sleep
colnames(usa)
table(usa$x.totinda)
usa_2013 = usa %>% mutate(
sleptim1 = replace(sleptim1, sleptim1 < 7, 2),
sleptim1 = replace(sleptim1, sleptim1 >= 7, 1),
sleptim1 = replace(sleptim1, sleptim1 == 77 | sleptim1 == 99, NA),
bphigh4 = replace(bphigh4, bphigh4 == 2 | bphigh4 == 3 | bphigh4 == 4, 0 ),
bphigh4 = replace(bphigh4, bphigh4 == 7 | bphigh4 == 9, NA ),
diabete3 = replace(diabete3, diabete3 == 2 | diabete3 == 3 | diabete3 == 4, 0 ),
diabete3 = replace(diabete3, diabete3 == 7 | diabete3 == 9, NA ),
drnkany5 = replace(drnkany5, drnkany5 == 2,0),
drnkany5 = replace(drnkany5, drnkany5 == 7 | drnkany5 == 9,NA),
x.totinda = replace(x.totinda, x.totinda == 9, NA)
)
brfss_design = svydesign(data = usa_2013,
weights = ~x.llcpwt,
ids = ~1,
nest=T)
cols = c('Sex','Smoking.status','Enough.sleep','Taking.medication.for.hypertenstion',
'Taking.medication.for.diabetes', 'Alcohol.drinking.category',
'Walking.or.physical.activity.category')
japan_2013[cols] = lapply(japan_2013[cols], as.factor)
prop.table(svytable(~x.totinda, brfss_design))
prop.table(table(japan_2013$Walking.or.physical.activity.category))
per_phy_usa = data.frame(prop.table(svytable(~x.totinda, brfss_design)))
per_phy_japan = data.frame(prop.table(table(japan_2013$Walking.or.physical.activity.category)))
per_phy_usa = convert_fun(per_phy_usa, '% had physical activity**', 'USA' )
per_phy_usa
per_phy_japan = convert_fun(per_phy_japan,'% had physical activity**', 'Japan')
per_phy_japan
per_phy = rbind(per_phy_japan,per_phy_usa)
per_phy = per_phy %>% gather('metric','status',1)
metrics_df = do.call('rbind',list(per_sleep,per_dia,per_smo,per_ht,per_alc,per_phy))
metrics_yes_df = metrics_df %>% filter(status == 'Yes')
metrics_yes_df$status = NULL
colnames(metrics_yes_df)[1] = 'value'
metrics_yes_df
new_df
data_df = rbind(new_df,metrics_yes_df)
data_df = data_df %>% spread(Country,value)
data_df
theme_set(theme_classic())
left_label <- paste(data_df$metric, data_df$USA,sep=", ")
right_label <- paste(data_df$metric,data_df$Japan,sep=", ")
data_df$class <- ifelse(data_df$USA > data_df$Japan, "red", "green")
p = ggplot(data_df) + geom_segment(aes(x=1, xend=2, y=USA, yend=Japan, col=class), size=.75, show.legend=F) +
geom_vline(xintercept=1, linetype="dashed", size=.1) +
geom_vline(xintercept=2, linetype="dashed", size=.1) +
scale_color_manual(labels = c("Up", "Down"),
values = c("green"="#00ba38", "red"="#f8766d")) +  # color of lines
labs(x="", y="") +  # Axis labels
ggtitle('Lifestyle habits and metrics comparison ')+
xlim(0, 3) + ylim(0,(1.1*(max(data_df$USA, data_df$Japan))))  # X and Y axis limits
# Add texts
p = p + geom_text_repel(label=left_label, y=data_df$USA, x=rep(1, NROW(data_df)), hjust=1.1, size=3.5)
p = p + geom_text_repel(label=right_label, y=data_df$Japan, x=rep(2, NROW(data_df)), hjust=-0.1, size=3.5)
p = p + geom_text(label="USA", x=1, y=1.1*max(data_df$USA, data_df$Japan), hjust=1.2, size=5)  # title
p = p + geom_text(label="Japan", x=2, y=1.1*(max(data_df$USA, data_df$Japan)), hjust=-0.1, size=5)  # title
# Minify theme
p + theme(panel.background = element_blank(),
panel.grid = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_blank(),
panel.border = element_blank())
#plot.margin = unit(c(1,2,1,2), "cm"))
p
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
# Create UI of the shiny app page, displaying various User input interfaces and
# visualizations according to the given data
metrics <- data_df$metric %>% as.character()
setwd("C:/Users/kiran/Desktop/info478-JPNLifestyle")
source("analysis.R")
install.packages("lettercase")
runApp()
runApp()
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
runApp()
max(data_df$USA, data_df$Japan)
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
runApp()
runApp()
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
brfss_design = svydesign(data = usa_2013,
weights = ~x.llcpwt,
ids = ~1,
nest=T)
per_phy_usa = data.frame(prop.table(svytable(~x.totinda, brfss_design)))
per_phy_usa
per_smo
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
japan_2013 %>% group_by(Sex) %>% count(Smoking.status)
japan_2013 %>% group_by(Age) %>% count(Smoking.status)
japan_2013 %>% group_by(Age) %>% count(Smoking.status) %>%
ggplot(aes(Age, n))+
geom_bar(stat = 'identity', aes(fill= Smoking.status),position='dodge')
japan_2013 %>% group_by(Age) %>% count(Smoking.status) %>%
ggplot(aes(Age, n))+
geom_point(aes(fill= Smoking.status))
japan_2013 %>% group_by(Age) %>% count(Smoking.status) %>%
ggplot(aes(Age, n))+
geom_point(aes(col= Smoking.status))
japan_2013 %>% group_by(Age) %>% count(Smoking.status) %>%
ggplot(aes(Age, n))+
geom_line(aes(col= Smoking.status))
svyplot(x.rfsmok3~x.ageg5yr,design=brfss_design, style = 'subsample')
svyplot(x.rfsmok3~x.ageg5yr,design=brfss_design, style = 'transparent')
svytable(x.rfsmk3~x.ageg5yr)
svytable(x.rfsmk3~x.ageg5yr, design=brfss_design)
svytable(x.rfsmok3~x.ageg5yr, design=brfss_design)
svytable(~x.rfsmok3+x.ageg5yr, design=brfss_design)
prop.table(svytable(~x.rfsmok3+x.ageg5yr, design=brfss_design),margin=2)
smo_age_usa = data.frame(prop.table(svytable(~x.rfsmok3+x.ageg5yr,
design=brfss_design),margin=2))
smo_age_usa
smo_age_usa$x.rfsmok3 = ifelse(smo_age_usa$x.rfsmok3 == 0, 'No','Yes')
smo_age_usa = smo_age_usa %>% mutate(
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 5, '40-44'),
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 6, '45-49'),
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 7, '50-54'),
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 8, '55-59'),
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 9, '60-64'),
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 10, '65-69'),
x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 5, '70-74')
)
# smo_age_usa = smo_age_usa %>% mutate(
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 5, '40-44'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 6, '45-49'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 7, '50-54'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 8, '55-59'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 9, '60-64'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 10, '65-69'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 5, '70-74')
# )
smo_age_usa
smo_age_usa = data.frame(prop.table(svytable(~x.rfsmok3+x.ageg5yr,
design=brfss_design),margin=2))
smo_age_usa$x.rfsmok3 = ifelse(smo_age_usa$x.rfsmok3 == 0, 'No','Yes')
# smo_age_usa = smo_age_usa %>% mutate(
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 5, '40-44'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 6, '45-49'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 7, '50-54'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 8, '55-59'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 9, '60-64'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 10, '65-69'),
#   x.ageg5yr = replace(x.ageg5yr, x.ageg5yr == 5, '70-74')
# )
smo_age_usa
age_fun = function(x){
if (x < 45) {
y = 5
} else if (x >=45 & x < 50){
y = 6
} else if (x >= 50 & x <55){
y = 7
} else if (x >= 55 & x < 60){
y = 8
} else if (x >= 60 & x < 65){
y = 9
} else if (x >= 65 & x < 70){
y =10
} else {
y = 11
}
}
japan_2013$age_group = lapply(japan_2013$Age,age_fun )
head(japan_2013)
japan_2013 %>% group_by(age_group) %>% count(Smoking.status)
typeof(japan_2013$age_group)
japan_2013$age_group = as.numeric(japan_2013$age_group)
japan_2013 %>% group_by(age_group) %>% count(Smoking.status)
table(japan_2013$Smoking.status, japan_2013$age_group)
prop.table(table(japan_2013$Smoking.status, japan_2013$age_group),margin=2)
data.frame(prop.table(table(japan_2013$Smoking.status, japan_2013$age_group),margin=2))
smo_age_japen = data.frame(prop.table(table(japan_2013$Smoking.status, japan_2013$age_group),margin=2))
smo_age_japan = data.frame(prop.table(table(japan_2013$Smoking.status,
japan_2013$age_group),margin=2))
smo_age_japan$Var1 = ifelse(smo_age_japan == 0, 'No','Yes')
smo_age_japan
smo_age_japan = data.frame(prop.table(table(japan_2013$Smoking.status,
japan_2013$age_group),margin=2))
smo_age_japan$Var1 = ifelse(smo_age_japan$Var1 == 0, 'No','Yes')
smo_age_japan
smo_age = rbind(smo_age_usa,smo_age_japan)
colnames(smo_age_japan) = c('Smoking status','Age group', 'percentage')
colnames(smo_age_usa) = c('Smoking status','Age group', 'percentage')
smo_age = rbind(smo_age_usa,smo_age_japan)
smo_age
smo_age_japan$country = 'Japan'
smo_age_usa$country = 'USA'
smo_age = rbind(smo_age_usa,smo_age_japan)
smo_age
plot_ly(smo_age,x=~age_group, y=~percentage, color = ~country, type='bar')
plot_ly(smo_age,x=~Age.group, y=~percentage, color = ~country, type='bar')
plot_ly(smo_age,x=~`Age group`, y=~percentage, color = ~country, type='bar')
smo_age %>% group_by(`Smoking Status`) %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country, type='bar')
smo_age %>% group_by(`Smoking status`) %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country, type='bar')
smo_age %>% group_by(`Smoking status`) %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country, type='bar', fill=~`Smoking status`)
smo_age %>% group_by(country,`Smoking status`) %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country, type='bar')
smo_age %>% gather(country,`Smoking status`,-`Age group`,-percentage)
smo_age %>% gather('group','value',1,4)
smo_age %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country+`Smoking status`, type='bar', mode =)
smo_age %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country+`Smoking status`, type='bar')
smo_age %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~country+~`Smoking status`, type='bar')
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage, color = ~`Smoking status`, type='bar')%>%
add_trace(smo_age_japan,x=~`Age group`, y=~percerntage, color=~`Smoking status`)
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage, color = ~`Smoking status`, type='bar')%>%
add_trace(smo_age_japan,x=~`Age group`, y=~percentage, color=~`Smoking status`)
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage, color = ~`Smoking status`, type='bar', name='USA')%>%
add_trace(smo_age_japan,x=~`Age group`, y=~percentage, color=~`Smoking status`, name='Japan')
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage, color = ~`Smoking status`, type='bar')%>%
add_trace(smo_age_japan,x=~`Age group`, y=~percentage, color=~`Smoking status`)
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage, color = ~`Smoking status`, type='bar')%>%
add_trace(smo_age_japan,x=~`Age group`, y=~percentage, color=~`Smoking status`,colors='Set1')
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage,
color = ~`Smoking status`, type='bar')%>%
add_trace(smo_age_japan,x=~`Age group`, y=~percentage,
color=~`Smoking status`,colors='Set1')
plot_ly(smo_age_usa, x=~`Age group`, y=~percentage,
color = ~`Smoking status`, type='bar')
smo_age %>% gather('country','value',2:3)
smo_age
smo_age %>% gather('Japan','USA',3:4)
smo_age %>% spread(country,percentage)
smo_age$percentage = round(smo_age$percentage*100,2)
sdf = smo_age %>% spread(country,percentage)
plot_ly(sdf, x=~`Age group`, y=~Japan,
color = ~`Smoking status`, type='bar') %>%
add_trace(y=~USA,
color=~`Smoking status`)
plot_ly(sdf, x=~`Age group`, y=~Japan,
color = ~`Smoking status`, name = 'Japan',type='bar') %>%
add_trace(y=~USA,
color=~`Smoking status`, name='USA')
plot_ly(sdf, x=~`Age group`, y=~Japan,
color = ~`Smoking status`, name = 'Japan',type='bar') %>%
add_trace(y=~USA,
color=~`Smoking status`, name='USA',colors='Set1')
plot_ly(sdf, x=~`Age group`, y=~Japan,
color = ~`Smoking status`, text = 'Japan',type='bar') %>%
add_trace(y=~USA,
color=~`Smoking status`, text='USA',colors='Set1')
plot_ly(sdf, x=~`Age group`, y=~Japan, text = 'Japan',type='bar') %>%
add_trace(y=~USA, text='USA')
plot_ly(sdf, x=~`Age group`, y=~Japan,
color = ~`Smoking status`, text = 'Japan',type='bar') %>%
add_trace(y=~USA,
color=~`Smoking status`, text='USA')
smo_age$hover = with(smo_age, paste('country', country,'<br>',
'Smoking status',`Smoking status`))
smo_age
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text = hover, hoverinfo='text',colors = 'Set1')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text = hover, hoverinfo='text',colors = 'Set2')
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Set1')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Set2')
subplot(p1,p2)
p1
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Set1', type='bar')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Set2', type='bar')
subplot(p1,p2)
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Set2', type='bar')
p2
smo_age$hover = with(smo_age, paste('Country:', country,'<br>',
'Smoking status:',`Smoking status`))
plotly::subplots(p1,p2)
plotly::subplot(p1,p2)
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'viridis', type='bar')
plotly::subplot(p1,p2)
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Set1', type='bar')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = 'Viridis', type='bar')
plotly::subplot(p1,p2)
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('green','blue'), type='bar')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('red','yellow'), type='bar')
plotly::subplot(p1,p2)
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('red','grey'), type='bar')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('blue','orange'), type='bar')
plotly::subplot(p1,p2)
smo_age$hover = with(smo_age, paste('Country:', country,'<br>',
'Smoking status:',`Smoking status`,'<br>',
'Percentage:', percentage))
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('red','grey'), type='bar',
legendgroup ='group1')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('blue','orange'), type='bar',
legendgroup='group2')
plotly::subplot(p1,p2)
smo_age$legend = with(smo_age, paste(country,'-',`Smoking status`))
smo_age
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,name=~legend
text =~hover, hoverinfo='text',colors = c('red','grey'), type='bar',
legendgroup ='group1')
p1 = smo_age %>% filter(country == 'USA') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,name=~legend,
text =~hover, hoverinfo='text',colors = c('red','grey'), type='bar',
legendgroup ='group1')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`,
text =~hover, hoverinfo='text',colors = c('blue','orange'), type='bar',
legendgroup='group2')
plotly::subplot(p1,p2)
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`, name=~legend
text =~hover, hoverinfo='text',colors = c('blue','orange'), type='bar',
legendgroup='group2')
p2 = smo_age %>% filter(country == 'Japan') %>%
plot_ly(x=~`Age group`, y=~percentage, color = ~`Smoking status`, name=~legend,
text =~hover, hoverinfo='text',colors = c('blue','orange'), type='bar',
legendgroup='group2')
plotly::subplot(p1,p2)
plot_ly(sdf, x=~`Age group`, y=~Japan,
color = ~`Smoking status`, text = 'Japan',type='bar') %>%
add_trace(y=~USA,
color=~`Smoking status`, text='USA')
sdf %>% filter(`Smoking status` == 'Yes') %>%
plot_ly( x=~`Age group`, y=~Japan,
color = ~Japan, name = 'Japan',type='bar') %>%
add_trace(y=~USA,
color=~USA, name='USA')
sdf %>% filter(`Smoking status` == 'Yes') %>%
plot_ly( x=~`Age group`, y=~Japan,name = 'Japan',type='bar') %>%
add_trace(y=~USA, name='USA')
age_fun = function(x){
if (x < 45) {
y = '40-44'
} else if (x >=45 & x < 50){
y = '45-49'
} else if (x >= 50 & x <55){
y = '50-54'
} else if (x >= 55 & x < 60){
y = '55-59'
} else if (x >= 60 & x < 65){
y = '60-64'
} else if (x >= 65 & x < 70){
y = '65-69'
} else {
y = '70+'
}
}
japan_2013$age_group = lapply(japan_2013$Age,age_fun )
typeof(japan_2013$age_group)
japan_2013$age_group = as.character(japan_2013$age_group)
smo_age_japan = data.frame(prop.table(table(japan_2013$Smoking.status,
japan_2013$age_group),margin=2))
smo_age_japan$Var1 = ifelse(smo_age_japan$Var1 == 0, 'No','Yes')
colnames(smo_age_japan) = c('Smoking status','Age group', 'percentage')
smo_age_japan$country = 'Japan'
smo_age_japan
age_fun_usa = function(x){
if (x == 5) {
y = '40-44'
} else if (x == 6){
y = '45-49'
} else if (x == 7){
y = '50-54'
} else if (x ==8){
y = '55-59'
} else if (x == 9){
y = '60-64'
} else if (x == 10){
y = '65-69'
} else {
y = '70+'
}
}
smo_age_usa$`Age group` = lapply(smo_age_usa$`Age group`,age_fun_usa)
smo_age_usa$`Age group` = as.character(smo_age_usa$`Age group`)
smo_age = rbind(smo_age_usa,smo_age_japan)
smo_age$percentage = round(smo_age$percentage*100,2)
smo_age
smo_age %>% filter(`Smoking status` == 'Yes') %>%
plot_ly(x=~`Age group`, y=~percentage, color=~country,colors='Rdbu', type='bar')
smo_age %>% filter(`Smoking status` == 'Yes') %>%
plot_ly(x=~`Age group`, y=~percentage, color=~country, type='bar')
smo_age %>% filter(`Smoking status` == 'Yes') %>%
plot_ly(x=~`Age group`, y=~percentage, color=~country, type='bar', colors='Set1')
smo_age %>% filter(`Smoking status` == 'Yes') %>%
plot_ly(x=~`Age group`, y=~percentage, color=~country, text = '% of smokers'
type='bar', colors='Set1')
smo_age %>% filter(`Smoking status` == 'Yes') %>%
plot_ly(x=~`Age group`, y=~percentage, color=~country, text = '% of smokers',
type='bar', colors='Set1')
table(japan_2013$Smoking.status,japan_2013$age_group,japan_2013$Sex)
prop.table(table(japan_2013$Smoking.status,japan_2013$age_group,japan_2013$Sex))
prop.table(table(japan_2013$Smoking.status,japan_2013$age_group,japan_2013$Sex), margin = 2)
japan_2013_smo = japan_2013 %>% filter(Smoking.status == 1)
prop.table(table(japan_2013_smo$age_group,japan_2013_smo$Sex), margin = 2)
prop.table(table(japan_2013$Smoking.status,japan_2013$age_group,japan_2013$Sex), margin = 2)
data.frame(prop.table(table(japan_2013$Smoking.status,japan_2013$age_group,
japan_2013$Sex), margin = 2))
japan_2013$gender = ifelse(japan_2013$Sex == 0, 'Female','Male')
data.frame(prop.table(table(japan_2013$Smoking.status,japan_2013$age_group,
japan_2013$gender), margin = 2))
smojg = data.frame(prop.table(table(japan_2013$Smoking.status,japan_2013$age_group,
japan_2013$gender), margin = 2))
smo_jap_gen = smojg %>% filter(Var1==1)
smo_jap_gen
smo_jap_gen = smo_jap_gen %>% spread(Var3,Freq)
smo_jap_gen
smo_jap_gen = smojg %>% filter(Var1==1)
smo_jap_gen = smo_jap_gen %>% spread(Var3,round(Freq,2))
smo_jap_gen
smo_jap_gen = smo_jap_gen %>% spread(Var3,Freq)
smo_jap_gen
smo_age
smo_age_japan
smoy_age_japan = smo_age_japan %>% filter(`Smoking status`=='Yes')
smoy_age_japan
smo_age_gen_jap = left_join(smoy_age_japan,smo_jap_gen, by = c(`Age group` = Var2))
?left_join
smo_jap_gen
smo_age_gen_jap = left_join(smoy_age_japan,smo_jap_gen, by = c(`Age group` = smo_jap_gen$Var2))
smo_age_gen_jap = left_join(smoy_age_japan,smo_jap_gen, by = c(`Age group` = 'Var2'))
smo_age_gen_jap
smo_age_gen_jap['Smoking status','Var1']=NULL
smo_age_gen_jap['Smoking status']= NULL
smo_age_gen_jap['Var1'] = NULL
smo_age_gen_jap
svytable(~x.rfsmok3+x.ageg5yr+sex)
svytable(~x.rfsmok3+x.ageg5yr+sex, brfss_design)
prop.table(svytable(~x.rfsmok3+x.ageg5yr+sex, brfss_design),margin = 2)
smo_usa_gen = data.frame(prop.table(svytable(~x.rfsmok3+x.ageg5yr+sex, brfss_design),margin = 2))
smo_usa_gen
smo_usa_gen$sex = ifelse(sex==1, 'Male', 'Female')
smo_usa_gen$sex = ifelse(smo_usa_gen$sex==1, 'Male', 'Female')
smo_usa_gen$x.ageg5yr = lapply(smo_usa_gen$x.ageg5yr,age_fun_usa)
smo_usa_gen
smo_usa_gen = smo_usa_gen %>% filter(x.rfsmok3==1)
smo_usa_gen = smo_usa_gen %>% spread(sex,Freq)
smo_usa_gen
smo_usa_gen$x.rfsmok3 = NULL
smo_usa_gen$x.ageg5yr = as.character(smo_usa_gen$x.ageg5yr)
smo_age_usa
smoy_age_usa = smo_age_usa %>% filter(smo_age_usa$`Smoking status`=='Yes')
smo_age_gen_usa = left_join(smoy_age_usa,smo_usa_gen, by=c(`Age group` = 'x.ageg5yr'))
smo_age_gen_usa
smo_age_gen_jap
smo_age_gen_usa['Smoking status'] = NULL
smo_age_gen_usa
smo_age_gen_jap
smo_age_gen = rbind(smo_age_gen_usa, smo_age_gen_jap)
smo_age_gen
smo_age_gen['percentage','Female','Male'] = smo_age_gen['percentage','Female','Male']*100
smo_age_gen$percentage = round(smo_age_gen$percentage*100,2)
smo_age_gen$Female = round(smo_age_gen$Female*100,2)
smo_age_gen$Male = round(smo_age_gen$Male*100, 2)
smo_age_gen
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
source('C:/Users/kiran/Desktop/info478-JPNLifestyle/analysis.R')
